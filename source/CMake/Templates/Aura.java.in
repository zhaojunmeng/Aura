package com.cesardev.aura;

import com.qualcomm.QCAR.QCAR;

import android.app.NativeActivity;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.view.WindowManager;

/** Activity to do some initializations:
    - Load shared libraries
    - Init QCAR (Only in Java)
*/
public class Aura extends NativeActivity
{
    /** Static initializer block to load native libraries on start-up. */
    static
    {
    	System.loadLibrary("QCAR");
    	System.loadLibrary("TestApp");
    }
    
    int width, height;

    private native void initQCARNative(int width, int height);
    
    /** Stores screen dimensions */
    private void storeScreenDimensions()
    {
        // Query display dimensions:
        DisplayMetrics metrics = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics(metrics);
	width = metrics.widthPixels;
	height = metrics.heightPixels;
    }

    
    protected void onCreate(Bundle savedInstanceState){ 
    	super.onCreate(savedInstanceState);        
    	    	
        // As long as this window is visible to the user, keep the device's
        // screen turned on and bright:
        getWindow().setFlags(
			     WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON,
			     WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);

    	// We need a Java part :)
    	QCAR.setInitParameters(this, 2);
    	QCAR.init();
	storeScreenDimensions();
    	initQCARNative(width, height);
    }  

    protected void onDestroy()
    {
        super.onDestroy();
        QCAR.deinit();
        System.gc();
    }
}
